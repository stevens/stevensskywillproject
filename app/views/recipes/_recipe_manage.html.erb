<% if item_manageable?(item) %>
	<% buttons = [] %>
	
	<% if item.entrying? %>
		<% buttons << [ [ 'entry', false, true, 'highlight' ], 
										[ '参赛中', url_for(:controller => 'matches', :action => 'profile', :id => item.match_id, :ref => ref) ]
									] %>
		<% hide_delete = true %>
	<% else %>
		<% if item.entriable? %>
			<% buttons << [ [ 'entry', false, true ], 
											[ '参赛', url_for(:recipe_id => item.id, :controller => 'entries', :action => 'new', :ref => ref, :filter => params[:filter]) ]
										] %>
		<% end %>
		
		<% if item.publishable? %>
			<% publish_message = "确定要发布这#{unit_for('Recipe')}#{RECIPE_CN}吗?" %>
			<% buttons << [ [ 'publish', true, true ], 
											[ '发布', url_for(:action => 'publish', :id => item.id, :to_publish => true, :ref => ref, :filter => params[:filter]), publish_message ] 
										] %>
		<% end %>
	<% end %>
	
	<% buttons << [ [ 'edit' ], 
									[ EDIT_CN, url_for(:action => 'edit', :id => item.id, :ref => ref, :filter => params[:filter]) ]
								] %>
	
	<% unless hide_delete %>
		<% delete_message = "确定要#{DELETE_CN}这#{unit_for('Recipe')}#{RECIPE_CN}吗?" %>
		<% buttons << [ [ 'delete' ], 
										[ DELETE_CN, url_for(:action => 'destroy', :id => item.id, :ref => ref, :filter => params[:filter]), delete_message, 'delete' ] 
									] %>
	<% end %>
	
	<%= render :partial => '/layouts/todo_bar', 
						 :locals => { :buttons => buttons } %>
	
<% end %>
